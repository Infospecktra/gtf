/* Generated by Together */
package org.yang.web.view.controls.jsStyle.calendar;
import org.yang.web.view.controls.WebControl;
import javax.servlet.jsp.JspWriter;
import java.util.Date;
import java.util.Calendar;
import org.yang.util.DateFormatter;

/**
 * @testcase org.test.org.yang.web.view.controls.jsStyle.TestNavigationList 
 */
public class GHWebCalendarDaily extends GHWebCalendar
{
   public GHWebCalendarDaily()
   {
      super();
      type = 2;
   }

   public void printBody(JspWriter writer) throws Exception
   {
      int maxDays = 0;
      Calendar calendar = Calendar.getInstance();
      if(-1!=displayedYear&&-1!=displayedMonth&&-1!=displayedDay)
      {
         calendar.set(displayedYear+1900, displayedMonth, 1);
         maxDays  = calendar.getActualMaximum(Calendar.DAY_OF_MONTH);
         if(displayedDay>maxDays)
            displayedDay = maxDays;
         calendar.set(Calendar.DATE, displayedDay);
      }
      else
      {
         maxDays  = calendar.getActualMaximum(Calendar.DAY_OF_MONTH);
      }

      Date displayedDate = calendar.getTime();
//&System.out.println("[WebCalendarDaily] ??????????????????????????????????????? Current date : " + displayedDate);
      int displayedWeekday = displayedDate.getDay();
      String bgcolor = "#003399"; 
   
      writer.println( "          <TR>");
      writer.println( "            <TD>");
      writer.println( "            <TABLE  align=\"center\" id=\"Table1\" cellSpacing=\"1\" cellPadding=\"1\" bgColor=\""+bgcolor+"\" border=\"0\">");
      writer.println( "              <TR>");
      writer.println( "                <TD vAlign=\"bottom\" align=\"left\" bgColor=\""+bgcolor+"\">");
      writer.println( "                  <TABLE id=\"Table5\" cellSpacing=\"1\" cellPadding=\"0\" width=\"100%\"  border=\"0\">");
      writer.println( "                    <TR>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"left\" bgColor=\""+bgcolor+"\"><A href=\"" + backwardActionLink + "\"><FONT face=\"\" color=\"#ffffff\" size=\"0\">&lt;&lt;</FONT></A></TD>");
      writer.println( "                      <input type=\"hidden\" name=\"calendarView\" value=\"2\">");
      writer.println( "                      <input type=\"hidden\" name=\"browseYear\" value=\"" + displayedYear +"\">");
      writer.println( "                      <input type=\"hidden\" name=\"browseMonth\" value=\"" + displayedMonth +"\">");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\""+bgcolor+"\"><FONT face=\"\" color=\"#ffffff\" size=\"0\">" + DateFormatter.getDateTimeString(displayedDate, "MMMM,yyyy") + "</FONT></TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"right\" bgColor=\""+bgcolor+"\"><A href=\"" + forwardActionLink + "\"><FONT face=\"\" color=\"#ffffff\" size=\"0\">&gt;&gt;</FONT></A></TD>");
      writer.println( "                    </TR>");
      writer.println( "                  </TABLE>");
      writer.println( "                </TD>");
      writer.println( "              </TR>");
      writer.println( "              <TR>");
      writer.println( "                <TD vAlign=\"bottom\" align=\"left\" bgColor=\""+bgcolor+"\">");
      writer.println( "                  <TABLE id=\"Table6\" cellSpacing=\"1\" cellPadding=\"0\" width=\"160\" border=\"0\">");
      writer.println( "                    <TR>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">Su</TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">Mo</TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">Tu</TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">We</TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">Th</TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">Fr</TD>");
      writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"7A69FA\">Sa</TD>");
      writer.println( "                    </TR>");

      int firstWeekday = (displayedWeekday - (displayedDay - 1))%7;
      if(firstWeekday<0)
        firstWeekday += 7;
      //int maxDays  = calendar.getActualMaximum(Calendar.DAY_OF_MONTH);

      int count = 0;
      int day = 0;
      String bgColor = "";
      while(day<maxDays)
      {
         writer.println( "                    <TR bgColor=\"#ffffff\">");
         for(int i=0; i<7; i++)
         {
            count++;
            day = count - firstWeekday;
            if(day<=maxDays&&day>0)
            {
               if(day==displayedDay)
               {
                 bgColor = "gold";
                 writer.println( "                      <input type=\"hidden\" name=\"browseDay\" value=\"" + day +"\">");
               }
               else
                 bgColor = "#ffffff";

               writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"" + bgColor +"\">");
               writer.println( "                        <A href=\"" + switchTimeActionLink + "&displayedDay=" + day + "\">");
               writer.println( "                          <FONT face=\"\" color=\"#000000\" size=\"0\">" + day + "</FONT>");
               writer.println( "                        </A>");
               writer.println( "                      </TD>");
            }
            else
               writer.println( "                      <TD vAlign=\"bottom\" align=\"middle\" bgColor=\"#ffffff\"><FONT face=\"\" color=\"#000000\" size=\"0\"></FONT></TD>");
         }
         writer.println( "                    </TR>");
      }

      writer.println( "                  </TABLE>");
      writer.println( "                </TD>");
      writer.println( "              </TR>");
      writer.println( "            </TABLE>");
      writer.println( "          </TD>");
      writer.println( "        </TR>");
   }
}