/* Generated by Together */

package org.yang.web.applicationContainer;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

import org.yang.web.controller.Secured;
import org.yang.web.controller.GenericBean;

public abstract class SecuredBean extends GenericBean implements Secured
{
   protected Passport passport = null;
   public void setPassPort(Passport passport) { this.passport = passport; }

   protected String appBase = null;
   public String getAppBase()
   {
      if(null==appBase){ appBase = passport.getSystemProperty("appbase"); }
      return appBase;
   }

   protected String guiBase = null;
   public String getGuiBase()
   {
      if(null==guiBase){ guiBase = passport.getSystemProperty("skin"); }
      return guiBase;
   }

   public boolean passSecurityCheck(HttpServletRequest request)
   {
       //&System.out.println("[SecuredBean::passSecurityCheck] Enter security check.");
       HttpSession session = request.getSession();
       Passport passport = null;

       if(null!=session &&
          null!=(passport=(Passport)session.getAttribute(Passport.DEPLOY_KEY)))
       {
          //&System.out.println("[SecuredBean::passSecurityCheck] After security check --- Pass!");
          //Passport is found in session -> good
          this.setPassPort(passport);
          return true;
       }

       //&System.out.println("[SecuredBean::passSecurityCheck] After security check --- Fail!");
       return false;
   }

   public String getCurrentServiceProperty(String key)
   {
      return passport.getCurrentServiceDescriptor().getEnviromentParameter(key);
   }

   public String calculateURL(String url)
   {
      return passport.calculateURL(url);
   }

   public boolean gotPermit(String service, String area)
   {
      return passport.hasArea(service, area);
   }

   public boolean gotPermit(String service, String area, String operation)
   {
       //System.out.println("[SecuredBean::gotPermit]--------->service="+service);   
       //System.out.println("[SecuredBean::gotPermit]--------->area="+area);   
	   //System.out.println("[SecuredBean::gotPermit]--------->operation="+operation);   
      
      return passport.hasAreaOperation(service, area, operation);
   }
}
